!function(t){"use strict";var o=t("body"),e=t(".htcompare-popup");o.append(`<div id="htcompare-error-modal" class="htcompare-error-modal" style="display:none">
    <div class="htcompare-error-modal-content">
        <button class="htcompare-error-modal-close">&times;</button>
        <div class="htcompare-error-modal-body"></div>
    </div>
</div>`);let a=t("#htcompare-error-modal");t(".htcompare-error-modal-close").on("click",function(){a.css("display","none")}),t(window).on("click",function(t){t.target==a[0]&&a.css("display","none")}),t("a.htcompare-btn").each(function(){let o=t(this);o.hasClass("added")&&o.html('<span class="htcompare-btn-text">'+o.data("added-text")+"</span>")});let n=`<div class="htcompare-notification">
    <div class="htcompare-notification-text">${evercompare.option_data.success_added_notification_text}</div>
    <span class="htcompare-notification-close">close</span>
</div>`;"on"===evercompare.option_data.enable_success_notification&&(o.append(n),o.on("click",".htcompare-notification-close",function(){o.find(".htcompare-notification").removeClass("open")}));let c=t=>{"on"===evercompare.option_data.enable_success_notification&&(o.find(".htcompare-notification-text").html(t),o.find(".htcompare-notification").addClass("open"),+evercompare.option_data.removed_notification_after>-1&&setTimeout(function(){o.find(".htcompare-notification").removeClass("open")},1e3*+evercompare.option_data.removed_notification_after))};function i(o){t(".htcompare-table").length>0&&(t(".htcompare-table").replaceWith(o.table),t(".evercompare-copy-link").on("click",function(o){r(t(this).closest(".ever-compare-shareable-link").find(".evercompare-share-link"),this)}))}function r(o,e){var a=t("<input>");t("body").append(a),a.val(t(o).text()).select(),document.execCommand("copy"),a.remove(),t(e).text(t(e).data("copytext")),setTimeout(function(){t(e).text(t(e).data("btntext"))},1e3)}o.on("click","a.htcompare-btn",function(n){var r=t(this),d=r.data("product_id"),s=r.data("added-text"),p=evercompare.option_data.success_added_notification_text.replace("{product_name}",r.data("product_title"));if("yes"===evercompare.popup&&"off"===evercompare.option_data.remove_on_click){if(n.preventDefault(),r.hasClass("added"))return o.find(".htcompare-popup").addClass("open"),!0}else if(r.hasClass("added"))return!0;n.preventDefault(),r.addClass("loading"),t.ajax({url:evercompare.ajaxurl,data:{action:"ever_compare_add_to_compare",nonce:evercompare.nonce,id:d},dataType:"json",method:"GET",success:function(n){let c="array"==typeof n.products?n.products:Object.values(n.products);n.table&&c.indexOf(d.toString())>=0?(i(n),e.addClass("open")):(t(".htcompare-error-modal-body").html(n.limitReached),a.css("display","flex"),console.log("Something wrong loading compare data")),o.find(".htcompare-counter").html(n.count)},error:function(t){console.log("Something wrong with AJAX response.")},complete:function(t){r.removeClass("loading");let o="array"==typeof t.responseJSON.products?t.responseJSON.products:Object.values(t.responseJSON.products);o.indexOf(d.toString())>=0&&(r.addClass("added"),r.html('<span class="htcompare-btn-text">'+s+"</span>")),c(p)}})}),evercompare.option_data.remove_on_click&&"on"===evercompare.option_data.remove_on_click&&o.on("click","a.htcompare-btn.added",function(e){e.preventDefault();var a=t(this),n=a.data("product_id"),i=evercompare.option_data.success_removed_notification_text.replace("{product_name}",a.data("product_title"));a.addClass("loading"),jQuery.ajax({url:evercompare.ajaxurl,data:{action:"ever_compare_remove_from_compare",nonce:evercompare.nonce,id:n},dataType:"json",method:"GET",success:function(t){t?o.find(".htcompare-counter").html(t.count):console.log("Something wrong loading compare data")},error:function(t){console.log("Something wrong with AJAX response.")},complete:function(){a.removeClass("loading added").html('<span class="htcompare-btn-text">'+a.data("text")+"</span>"),c(i)}})}),o.on("click","a.htcompare-remove",function(e){var a=t(".htcompare-table");e.preventDefault();var n=t(this),r=n.data("product_id"),d=evercompare.option_data.success_removed_notification_text.replace("{product_name}",n.data("product_title"));a.addClass("loading"),n.addClass("loading"),jQuery.ajax({url:evercompare.ajaxurl,data:{action:"ever_compare_remove_from_compare",nonce:evercompare.nonce,id:r},dataType:"json",method:"GET",success:function(e){e.table?i(e):console.log("Something wrong loading compare data"),t("a.htcompare-btn").each(function(){t(this).data("product_id")===r&&(t(this).removeClass("added"),t(this).html('<span class="htcompare-btn-text">'+t(this).data("text")+"</span>"))}),o.find(".htcompare-counter").html(e.count)},error:function(t){console.log("Something wrong with AJAX response.")},complete:function(){a.removeClass("loading"),n.addClass("loading"),c(d)}})}),o.on("click",".htcompare-popup-close",function(o){t(this).parent(".htcompare-popup.open").removeClass("open"),e.removeClass("open")}),t(".evercompare-copy-link").on("click",function(o){r(t(this).closest(".ever-compare-shareable-link").find(".evercompare-share-link"),this)})}(jQuery);